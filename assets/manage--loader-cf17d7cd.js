import{d as l}from"./db-e5ae38dc.js";import{l as g}from"./db_calls-7a24e399.js";import{i as v}from"./pocketbase-7569c031.js";import{j as y}from"./index-5ffe0fb5.js";const w=25,k=async({request:t,params:a})=>{var i,u;const e=new URL(t.url),n=Math.max(m("offset",e.searchParams)||0,0),c=Math.max(m("limit",e.searchParams)||w,10),[f,h]=await Promise.all([l.list.orderBy("createdAt").reverse().offset(n).limit(c).toArray(),l.list.count()]),s=[];for(const o of f){const r=await g(o.surveyId,P(o.surveyType));if(r){const _=(i=r==null?void 0:r.data)==null?void 0:i.ho_va_ten,d=(u=r==null?void 0:r.data)==null?void 0:u.nguoi_kham;let p={...o,extra:{ho_va_ten:_,nguoi_kham:d}};s.push(p)}else s.push({...o,extra:{}})}return y({list:s,count:h,offset:n,limit:c,auth:v()})};function x(t,a){return a.get(t)}function m(t,a){const e=x(t,a);return e&&parseInt(e)||null}function P(t){switch(t){case"mau_giao":return"mau_giao_form";case"tieu_hoc":return"tieu_hoc_form";case"nguoi_lon":return"nguoi_lon_form";case"who_children_surface":return"who_children_surface_form";case"research_coidp":return"research_coidp_form"}}export{w as defaultLimit,k as loader};
