import{d as m,j as v,p as y}from"./index-8ce674d0.js";import{l as x}from"./db_calls-40ce8bd5.js";const P=25,j=async({request:t,params:o})=>{var c,i,l;const e=new URL(t.url),n=Math.max(f("offset",e.searchParams)||0,0),u=Math.max(f("limit",e.searchParams)||P,10),[h,_]=await Promise.all([m.list.orderBy("createdAt").reverse().offset(n).limit(u).toArray(),m.list.count()]),s=[];for(const r of h){const a=await x(r.surveyId,S(r.surveyType));if(a){const d=(c=a==null?void 0:a.data)==null?void 0:c.ho_va_ten,p=(i=a==null?void 0:a.data)==null?void 0:i.nguoi_kham;let g={...r,extra:{ho_va_ten:d,nguoi_kham:p}};s.push(g)}else s.push({...r,extra:{}})}return v({list:s,count:_,offset:n,limit:u,auth:(l=y.authStore)==null?void 0:l.model})};function w(t,o){return o.get(t)}function f(t,o){const e=w(t,o);return e&&parseInt(e)||null}function S(t){switch(t){case"mau_giao":return"mau_giao_form";case"tieu_hoc":return"tieu_hoc_form";case"nguoi_lon":return"nguoi_lon_form"}}export{P as defaultLimit,j as loader};
