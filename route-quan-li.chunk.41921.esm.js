(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"2id+":function(t,e){"use strict";e.a={main:"main__1K-lV"}},"9L1P":function(t,e,r){"use strict";r.r(e),function(t){function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=r("7SJd"),s=r("lm/3"),c=r("W8jr"),u=r("UTjy"),l=r("9j8Y"),p=r("eucj");const h=t=>{switch(t){case"mau_giao":return"mau_giao_form";case"tieu_hoc":return"tieu_hoc_form";case"nguoi_lon":return"nguoi_lon_form"}},d=async(t,e)=>{let r=await a.b.list.orderBy("createdAt").reverse().offset(t).limit(e).toArray();const n=[];for(const t of r){const e=await Object(p.b)(t.surveyId,h(t.surveyType)),r=e&&e.data&&e.data.ho_va_ten;let i=o(o({},t),{},{name:r});n.push(i)}return n};e.default=({skip:e,pageSize:r})=>{const n=parseInt(e,10)||0,o=parseInt(r,10)||50,i=Object(s.a)(d,[n,o]);if(i.loading)return t("div",{className:"wrapper"},t(c.a,null));if(i.error)return console.error(i.error),t("div",{className:"wrapper"},t(u.a,{title:"Có lỗi xảy ra",explain:i.error.message}));if(i.result){return t(l.a,{surveys:i.result,offset:n,limit:o})}return t("div",{className:"wrapper"},t(u.a,{title:"Có lỗi xảy ra",explain:"Trường hợp này không hiểu tại sao xảy ra. quan-li.tsx:63"}))}}.call(this,r("hosL").h)},"9j8Y":function(t,e,r){"use strict";(function(t){async function n(t){switch(t.type){case"survey":await u.b.list.update(t.payload.surveyId,{syncStatus:u.a.Synced});break;case"surveyData":await u.b.data.update([t.payload.surveyId,t.payload.surveyForm],{syncStatus:u.a.Synced});break;case"surveyRevision":await u.b.revision.update(t.payload.surveyDataId,{syncStatus:u.a.Synced})}}r.d(e,"a",(function(){return w}));var o=r("pFNu"),i=r("l8WD"),a=r("QVZW"),s=r("lm/3"),c=r("ox/y"),u=r("7SJd"),l=r("eucj"),p=r("fkj1"),h=r("wGtP"),d=r("o7/e"),f=r("q/Mr"),y=r("eANb"),b=r("RKBc");var m;!function(t){t[t.Initial=0]="Initial",t[t.PrepareData=1]="PrepareData",t[t.Uploading=2]="Uploading",t[t.Done=3]="Done"}(m||(m={}));const w=({surveys:e,offset:r,limit:w})=>{const[g,v]=Object(i.useState)(0),[O,j]=Object(i.useState)(0),[_,E]=Object(i.useState)(m.Initial),P=Object(f.a)(),A=Object(s.b)((async()=>{try{const t=[];E(m.PrepareData),await Promise.all([u.b.list.where({syncStatus:u.a.NotSync}).each((e=>{t.push({type:"survey",payload:e})})),u.b.data.where({syncStatus:u.a.NotSync}).each((e=>{t.push({type:"surveyData",payload:e})})),u.b.revision.where({syncStatus:u.a.NotSync}).each((e=>{t.push({type:"surveyRevision",payload:e})}))]),j(0),v(t.length),E(m.Uploading);for(let e=0;e<t.length;e++){const r=t[e];await Object(p.a)(r,P),await n(r),j((t=>t+1))}E(m.Done),O===g?d.b.success("Đồng bộ dữ liệu thành công"):d.b.warn(`Có lỗi xảy ra khi đồng bộ. Chỉ đồng bộ được ${O}/${g} hồ sơ`)}catch(t){console.error(t),d.b.error("Có lỗi xảy ra khi đồng bộ dữ liệu")}}));return t("div",{className:o.a.wrapper},t("header",{className:o.a.header},t("h1",null,"Quản lí hồ sơ"),t(a.Button,{type:"button",secondary:!0,onClick:A.execute,disabled:A.loading},"Đồng bộ")),_===m.PrepareData&&t("div",{className:o.a.syncStatus},'"Đang tìm dữ liệu...."'),_===m.Uploading&&t("div",{className:o.a.syncStatus},t("span",null,"Tải dữ liệu lên ",O,"/",g)),_===m.Done&&t("div",{className:o.a.syncStatus},t("span",null,"Đồng bộ thành công")),t(y.a,{offset:r,limit:w}),t(a.Table,{bordered:!0,fullWidth:!0},t("thead",null,t("tr",null,t("th",{scope:"col"},"Mã số"),t("th",{scope:"col"},"Loại hồ sơ"),t("th",{scope:"col"},"Tên"),t("th",{scope:"col"},"Thời gian tạo"),t("td",null))),t("tbody",null,e.map((({surveyId:e,surveyType:r,name:n,createdAt:o})=>{return t("tr",{key:e},t("td",null,e),t("td",null,r),t("td",null,n),t("td",null,(i=o,Object(h.a)(new Date(i),"dd-MM-yyyy hh:mm:ss"))),t("td",null,t(c.Link,{href:`/survey/${e}`},t(a.Button,{type:"button"},"Xem")),t(a.Button,{type:"button",outline:!0,onClick:async()=>{let t=function(t){switch(t){case"mau_giao":return["mau_giao_form"];case"tieu_hoc":return["tieu_hoc_form","tieu_hoc_questionare","tieu_hoc_child_oidp"];case"nguoi_lon":return["nguoi_lon_form","nguoi_lon_questionare","nguoi_lon_ohip14"]}}(r),o=[];for(const r in t){let n=await Object(l.b)(e,t[r]);o.push(n)}var i=new Blob([JSON.stringify({surveyId:e,surveyType:r,surveyData:o})],{type:"text/plain;charset=utf-8"});Object(b.saveAs)(i,`${n}_${e}.voser`)}},"Tải về")));var i})))),t(y.a,{offset:r,limit:w}))}}).call(this,r("hosL").h)},RKBc:function(t,e,r){(function(r){var n,o;n=function(){"use strict";function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){c(n.response,e,r)},n.onerror=function(){console.error("could not download file")},n.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,e,r){var s=a.URL||a.webkitURL,c=document.createElement("a");c.download=e=e||t.name||"download",c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?i(c):o(c.href)?n(t,e,r):i(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){i(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,r,a){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),r);else if(o(t))n(t,r,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){i(s)}))}}:function(t,e,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,r);var i="application/octet-stream"===t.type,c=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||i&&c||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},l.readAsDataURL(t)}else{var p=a.URL||a.webkitURL,h=p.createObjectURL(t);o?o.location=h:location.href=h,o=null,setTimeout((function(){p.revokeObjectURL(h)}),4e4)}});a.saveAs=c.saveAs=c,t.exports=c},void 0===(o="function"==typeof n?n.apply(e,[]):n)||(t.exports=o)}).call(this,r("pCvA"))},eANb:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return c}));var n=r("l8WD"),o=r("7SJd"),i=r("UTjy"),a=r("Y3FI"),s=r("2id+");const c=({offset:e,limit:r})=>{const[c,u]=Object(n.useState)({type:"initial"});switch(Object(n.useEffect)((()=>{o.b.list.count().then((t=>u({type:"success",payload:t}))).catch((t=>{console.error(t),u({type:"error",payload:t.message})}))}),[]),c.type){case"initial":case"loading":return null;case"success":const n=c.payload,o=Math.ceil(n/r),u=Math.floor(e/r)+1;return t("div",{className:s.a.main},t("button",{type:"button",onClick:t=>{t.preventDefault(),Object(a.route)(`/quan_li/${(u-2)*r}/${r}`)},disabled:u<=1},"Trang trước ←"),t("span",null,"Trang ",u,"/",o," (",n," hồ sơ tất cả)"),t("button",{type:"button",onClick:t=>{t.preventDefault(),Object(a.route)(`/quan_li/${u*r}/${r}`)},disabled:u>=o},"Trang tiếp →"));case"error":return t("div",{className:"wrapper"},t(i.a,{title:"Đã có lỗi xảy ra",explain:c.payload}))}}}).call(this,r("hosL").h)},fkj1:function(t,e,r){"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){return"number"==typeof t&&!isNaN(t-t)}function s(t){return t.trim().replace(/^\/?/,"").replace(/\/?$/,"")}function c(t,e){return"string"==typeof e&&""!==e&&s(e).split("/").length%2==("doc"===t?0:1)}function u(t){var e,r,n,o;if(!function(t){return t instanceof F||t instanceof C||"string"==typeof t}(t))throw TypeError("Expected a Reference, Document or a path but got something else");return null!==(o=null!==(n=null===(r=null===(e=t)||void 0===e?void 0:e.__meta__)||void 0===r?void 0:r.path)&&void 0!==n?n:t.path)&&void 0!==o?o:s(t)}function l(t,e){const r="doc"===t,n=u(e);if(!c(t,n))throw TypeError(`You are trying to access a method reserved for ${r?"Documents":"Collections"} with a ${r?"Collection":"Document"}`);return n}function p(t){return Number.isInteger(t)&&t>=0}function h(t={},e){const r=[],n=encodeURIComponent;for(const o in t){if(void 0===t[o])continue;const i=e?`${e}.${o}`:o;if(Array.isArray(t[o]))t[o].forEach((t=>{r.push(`${i}=${n(t)}`)}));else if("object"!=typeof t[o])r.push(`${i}=${n(t[o])}`);else{const e=h(t[o],i);e&&r.push(e)}}return(!e&&r.length?"?":"")+r.join("&")}function d(t,e){let r=[];for(const n in t){if(t[n]instanceof R)continue;const o=e?`${e}.${n}`:n;null===t[n]||"object"!=typeof t[n]||Array.isArray(t[n])||t[n]instanceof Date?r.push(o):r=r.concat(d(t[n],o))}return r}function f(t,e){const r={};for(let[n,o]of Object.entries(t))if(void 0!==o)switch(n){case"exists":case"updateTime":r.currentDocument||(r.currentDocument={}),r.currentDocument[n]=o;break;case"updateMask":if(!e)break;o&&(r.updateMask={fieldPaths:d(e)});break;case"mask":r.mask={fieldPaths:o};break;default:r[n]=o}return r}function y(t,e){const r=Object.keys(t)[0];switch(t=t[r],r){case"integerValue":return Number(t);case"arrayValue":return t.values?t.values.map((t=>y(t,e))):[];case"mapValue":return b(t,e);case"timestampValue":return new Date(t);case"referenceValue":return new F(t.replace(e.rootPath,""),e);case"geoPointValue":return new k(t.latitude,t.longitude);case"stringValue":case"doubleValue":case"booleanValue":case"nullValue":case"bytesValue":return t}throw Error(`Invalid Firestore value_type "${r}"`)}function b(t,e){if(void 0===e)throw Error('Argument "db" is required but missing');const r={};for(const n in t.fields)r[n]=y(t.fields[n],e);return r}function m(t,e,r){const n=Object.prototype.toString.call(t);let o=n.substring(8,n.length-1).toLowerCase()+"Value";switch(o){case"numberValue":o=Number.isInteger(t)?"integerValue":"doubleValue",t="integerValue"===o?String(t):t;break;case"arrayValue":t=t.length?{values:t.map(m)}:{};break;case"dateValue":o="timestampValue",t=t.toISOString();break;case"objectValue":if(t instanceof F||t instanceof k)return t.toJSON();o="mapValue",t=w(t,e,r)}return{[o]:t}}function w(t,e,r){const n=Object.keys(t);if(0===n.length)return{};const o={fields:{}};for(const i of n){if(void 0===t[i])continue;const n=t[i],a=r?`${r}.${i}`:i;n instanceof R?(n.fieldPath=a,e&&e.push(n)):o.fields[i]=m(n,e,a)}return o}function g(){return g=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},g.apply(this,arguments)}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function O(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function A(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(){return S=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},S.apply(this,arguments)}async function D(t){if(!t.ok){const e=await t.json();if(Array.isArray(e))throw 1===e.length?S(new Error,e[0].error):e;throw S(new Error,e.error)}return t.json()}function N(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function T(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?N(Object(r),!0).forEach((function(e){$(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function $(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)e.indexOf(r=i[n])>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)e.indexOf(r=i[n])>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}r.d(e,"a",(function(){return Q}));class k{constructor(t,e){if(this.latitude=t,this.longitude=e,"number"!=typeof t)throw Error("The latitude argument should be of type number");if("number"!=typeof t)throw Error("The longitude argument should be of type number");if(t>=90||t<=-90)throw Error("GeoPoint's latitude should be within the range of -90.0 and 90.0");if(e>=180||e<=-180)throw Error("GeoPoint's longitude should be within the range of -180.0 and 180.0")}toJSON(){return{geoPointValue:o({},this)}}}const x={serverTimestamp:["setToServerValue"],increment:["increment",a],max:["maximum",a],min:["minimum",a],appendToArray:["appendMissingElements",Array.isArray],removeFromArray:["removeAllFromArray",Array.isArray]};class R{constructor(t,e){if(!(t in x))throw Error(`Invalid transform name: "${t}"`);const[r,n]=x[t];if(n&&!n(e))throw Error(`The value for the transform "${t}" needs to be a${n===a?" number":"n array"}.`);this[r]=n===Array.isArray?m(e).arrayValue:"serverTimestamp"===t?"REQUEST_TIME":m(e)}}class C{constructor(t,e){if(void 0===e)throw Error('Argument "db" is required but missing');const{name:r,createTime:n,updateTime:o}=t,i={db:e,name:r,createTime:n,updateTime:o,path:r.replace(e.rootPath,""),id:r.split("/").pop()};Object.defineProperty(this,"__meta__",{value:i}),g(this,b(t,e))}}const L={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL",contains:"ARRAY_CONTAINS","contains-any":"ARRAY_CONTAINS_ANY",in:"IN"},V={select(t){const e=t.map((t=>({fieldPath:t})));return e.length?{fields:e}:void 0},encodeFilter:([t,e,r])=>Number.isNaN(r)||null===r?{unaryFilter:{field:{fieldPath:t},op:Number.isNaN(r)?"IS_NAN":"IS_NULL"}}:{fieldFilter:{field:{fieldPath:t},op:L[e],value:m(r)}},where(t){if(0!==t.length)return 1===t.length?this.encodeFilter(t[0]):{compositeFilter:{op:"AND",filters:t.map(this.encodeFilter)}}},orderBy(t,e){var r,n,o;return(e.startAt||e.endAt)&&"__name__"!==(null===(r=t[t.length-1])||void 0===r?void 0:r.field.fieldPath)&&t.push({field:{fieldPath:"__name__"},direction:null!==(o=null===(n=t[t.length-1])||void 0===n?void 0:n.direction)&&void 0!==o?o:"ASCENDING"}),t},documentToCursor(t,e){const r=[];for(let n of e.orderBy){if("__name__"===n.field.fieldPath){r.push({referenceValue:t.__meta__.name});continue}const e=t[n.field.fieldPath];e&&r.push(m(e))}return{values:r,before:!0}},startAt(t,e){return this.documentToCursor(t,e)},endAt(t,e){return this.startAt(t,e)}},U=["select","from","where","orderBy","startAt","endAt","offset","limit"];class B{constructor(t,e={}){if(this.parent=t,this.options={select:[],where:[],orderBy:[]},r="doc",!((n=t)instanceof F&&("doc"===r?!n.isCollection:n.isCollection)))throw Error("Expected parent to be a reference to a document");var r,n;for(const t of U){const r=e[t];if(t in e){if("where"===t&&Array.isArray(r[0])||"orderBy"===t&&Array.isArray(r)){r.forEach(((e,r)=>{try{this[t](e)}catch(e){throw Error(`Invalid argument "${t}[${r}]": ${e.message}`)}}));continue}try{this[t](r)}catch(e){throw Error(`Invalid argument "${t}": ${e.message}`)}}}}select(t){if(!Array.isArray(t))throw Error("Expected argument to be an array of field paths");t.forEach(((t,e)=>{if("string"!=typeof t)throw Error(`Field path at index [${e}] is not a string`);this.options.select.push(t)}))}from(t){let{collectionId:e=t,allDescendants:r}=t;if("string"!=typeof e)throw Error('Expected "collectionId" to be a string');if(void 0!==r&&"boolean"!=typeof r)throw Error('Expected the "allDescendants" to be a boolean');return this.options.from={collectionId:e,allDescendants:r},this}where(t){const e=Array.isArray(t)?t:arguments;return function(t){if(!Array.isArray(t)||3!==t.length)throw Error("Filter missing arguments");const[e,r,n]=t;if("string"!=typeof e)throw Error("Invalid field path");if(!(r in L))throw Error("Invalid operator");if((null===n||Number.isNaN(n))&&"=="!==t[1])throw Error("Null and NaN can only be used with the == operator");if(void 0===n)throw Error("Invalid comparative value")}(e),this.options.where.push(e),this}orderBy(t,e="asc"){let{field:r=t,direction:n=e}=t;if(n={asc:"ASCENDING",desc:"DESCENDING"}[n],"string"!=typeof r)throw Error('"field" property needs to be a string');if(void 0===n)throw Error('"direction" property can only be "asc" or "desc"');return this.options.orderBy.push({field:{fieldPath:r},direction:n}),this}startAt(t){if(!(t instanceof C))throw Error("Expected a Document instance");return this.options.startAt=t,this}endAt(t){if(!(t instanceof C))throw Error("Expected a Document instance");return this.options.endAt=t,this}offset(t){if(!p(t))throw Error("Expected an integer that is greater than 0");return this.options.offset=t,this}limit(t){if(!p(t))throw Error("Expected an integer that is greater than 0");return this.options.limit=t,this}async run(){var t;let e=await this.parent.db.fetch(this.parent.endpoint+":runQuery",{method:"POST",body:JSON.stringify(this)});return(null===(t=e[0])||void 0===t?void 0:t.document)||e.splice(0,1),e.map((t=>new C(t.document,this.parent.db)))}toJSON(){const t={};for(const e in this.options){const r=this.options[e];e in V?t[e]=V[e](r,this.options):t[e]=r}return{structuredQuery:t}}}class M{constructor(t,e,r={}){if(void 0===e)throw Error('The "reference" argument is required when creating a List');if(!e.isCollection)throw Error("The reference in a list should point to a collection");const{documents:n,nextPageToken:o}=t;this.ref=e,this.options=r,this.documents=n?n.map((t=>new C(t,e.db))):[],this.options.pageToken=o}getNextPage(){return this.ref.list(this.options)}[Symbol.iterator](){let t=0;return{next:()=>t<this.documents.length?{value:this.documents[t++],done:!1}:{done:!0}}}}class F{constructor(t,e){var r;if(this.db=e,"string"!=typeof t)throw Error('The "path" argument should be a string');t=s(t),this.id=null!==(r=t.split("/").pop())&&void 0!==r?r:"",this.path=t,this.name=`${e.rootPath}/${t}`,this.endpoint=`${e.endpoint}/${t}`,this.isRoot=""===t}get parent(){if(this.isRoot)throw Error("Can't get the parent of root");return new F(this.path.replace(/\/?([^/]+)\/?$/,""),this.db)}get parentCollection(){if(this.isRoot)throw Error("Can't get parent of a root collection");return this.isCollection?new F(this.path.replace(/(\/([^/]+)\/?){2}$|^([^/]+)$/,""),this.db):this.parent}get isCollection(){return c("col",this.path)}child(t){return t=t.replace(/^\/?/,""),new F(`${this.path}/${t}`,this.db)}async transact(t,e,r={}){const n=this.db.transaction(),o=n[t](this,e,r);return await n.commit().then((()=>o))}async list(t={}){return l("col",this),new M(await this.db.fetch(this.endpoint+h(f(t))),this,t)}async get(t={}){return l("doc",this),new C(await this.db.fetch(this.endpoint+h(f(t))),this.db)}async add(t,e={}){return l("col",this),this.transact("add",t,e)}async set(t,e={}){return l("doc",this),this.transact("set",t,e)}async update(t,e={}){return l("doc",this),this.transact("update",t,e)}async delete(t={}){return l("doc",this),this.transact("delete",t)}query(t={}){return l("col",this),new B(this.parent,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){O(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({from:{collectionId:this.id}},t))}toJSON(){return{referenceValue:this.name}}}class q{constructor(t){this.db=t,this.writes=[],this.preconditions={}}write(t,e,r={}){if("object"!=typeof e)throw Error("The data argument is missing");const n=[],o=`${this.db.rootPath}/${u(t)}`,i=this.preconditions[o],a=w(t instanceof C?t:e,n);r=f(r,e),i&&(r.currentDocument=i),a.name=o,this.writes.push(_({update:a},r)),n.length&&this.writes.push({transform:{document:a.name,fieldTransforms:n}})}async get(t){const e=await this.db.batchGet(t);return e.forEach((t=>{const{name:e,updateTime:r}=t.__meta__||{name:t.__missing__};this.preconditions[e]=r?{updateTime:r}:{exists:!1}})),e}add(t,e,r={}){const n=`${l("col",t)}/${function(){const t=crypto.getRandomValues(new Uint8Array(20));return Array.from(t).map((t=>"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890"[t%63])).join("")}()}`;return this.write(n,e,_({exists:!1},r)),this.db.ref(n)}set(t,e,r={}){l("doc",t),this.write(t,e,r)}update(t,e,r={}){l("doc",t),this.write(t,e,_({exists:!0,updateMask:!0},r))}delete(t,e={}){const r=`${this.db.rootPath}/${l("doc",t)}`;e=f(e),this.preconditions[r]&&(e.currentDocument=this.preconditions[r]),this.writes.push(_({delete:r},e))}async commit(){this.preconditions={},await this.db.fetch(this.db.endpoint+":commit",{method:"POST",body:JSON.stringify({writes:this.writes})})}}const J=["syncStatus"],G=["syncStatus"],H=new class{constructor({projectId:t,auth:e,name:r="(default)",host:n="firestore.googleapis.com",ssl:o=!0}){if(void 0===t)throw Error('Database constructor expected the "config" argument to have a valid "projectId" property');this.name=r,this.auth=e,this.rootPath=`projects/${t}/databases/${r}/documents`,this.endpoint=`http${o?"s":""}://${n}/v1/${this.rootPath}`}fetch(t,e){return this.auth&&this.auth.authorizedRequest?this.auth.authorizedRequest(t,e).then(D):fetch(t,e).then(D)}ref(t){return t instanceof C&&(t=t.__meta__.path),new F(t,this)}async batchGet(t){return(await this.fetch(this.endpoint+":batchGet",{method:"POST",body:JSON.stringify({documents:t.map((t=>{const e=l("doc",t);return`${this.rootPath}/${e}`}))})})).map((t=>t.found?new C(t.found,this):Object.defineProperty({},"__missing__",{value:t.missing})))}transaction(){return new q(this)}async runTransaction(t,e=5){const r=new q(this);for(;e>0;){await t(r);try{await r.commit();break}catch(t){if(0===e||"NOT_FOUND"!==t.status&&"FAILED_PRECONDITION"!==t.status)throw Error(t)}e--}}collectionGroup(t,e={}){return new B(this.ref("parent"in e?e.parent:""),function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({from:{collectionId:t,allDescendants:!0}},e))}}({projectId:"thucdia-e52ff"}),Q=async(t,e)=>{switch(t.type){case"survey":return await(async(t,e,r)=>{const n=H.ref(`prod--${t}/${e.surveyId}`),o=I(e,J);return await n.set(T(T({},o),{},{machineId:r}))})(t.type,t.payload,e);case"surveyData":case"surveyRevision":return await(async(t,e,r)=>{const n=H.ref(`prod--${t}/${e.surveyDataId}`),o=I(e,G);return await n.set(T(T({},o),{},{machineId:r}))})(t.type,t.payload,e)}}},pFNu:function(t,e){"use strict";e.a={wrapper:"wrapper__1x8n1",header:"header__3tjqy",syncStatus:"syncStatus__29ty1"}},"q/Mr":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r("7SJd");const o="voser__machineId",i=()=>{const t=window.localStorage.getItem(o);if(t)return t;{const t=Object(n.c)();return window.localStorage.setItem(o,t),t}}}}]);
//# sourceMappingURL=route-quan-li.chunk.41921.esm.js.map